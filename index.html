<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="reveal/css/reveal.css">
    <link rel="stylesheet" href="reveal/css/theme/kontur-light.css" id="theme">
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="reveal/css/highlight/idea-for-light.css">
    <link rel="stylesheet" href="reveal/css/highlight/darkula-for-dark.css">
    <!--[if lt IE 9]>
    <script src="reveal/js/html5shiv.js"></script>
    <![endif]-->
	<script defer src="reveal/js/head.min.js"></script>
	<script defer src="reveal/js/reveal.js"></script>
	<script defer src="reveal/initialize.js"></script>
	<script defer src="reveal/js/d3.min.js"></script>

    <style>
		.fragment-container {
			position: relative;
		}

		.fragment-container .fragment {
			position: absolute;
			top: 0px;
			width: 100%;
		}

        .tools.tools {
          margin: -30% auto 0;
          height: 100vh;
          display: block;
        }
    </style>

	<title>React</title>
</head>
<body>

<div class="reveal"><div class="slides">

<section data-markdown><script type="text/template">

# React

</script></section>

<section data-markdown><script type="text/template">

## First, the most ~~longest~~ important thing

Download all the necessary Node.js packages:
```
cd tasks
npm install
```

Then, run the dev server to see the results of task solutions:
```cmd
npm run start
```

You can view it at <a href="http://localhost:8080">http://localhost:8080</a>

Automatic rebuilding is in place as long as the dev server is running.

</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## Why did we need React?

***

### Layers of HTML, JS, CSS üò´

<pre><code class="lang-js hljs">
HTML =================================
CSS  ======
JS   ===
</code>
</pre>

Convenient for documents, for data, but not for applications

***

### Component-based approach üòç

```
HTML+CSS+JS   |   HTML+CSS+JS   |   HTML+CSS+JS
```

- Each component = HTML + JS + CSS
- Can be combined and reused!
- Isolated: in contrast to regular CSS

***

![children components](assets/components.png)

***

### HTML - a limited language üòû

<pre><code class="lang-html hljs">
&lt;script&gt;
  function handleClick() {
    ...
  }
&lt;/script&gt;

&lt;input type="button" onclick="handleClick()"/&gt;</code></pre>

Want methods and handler descriptions right away

***

### JSX = HTML + JS üòá

```js
function ButtonWithHandle() {
  function handleClick() {
    ...
  }

  return <input type="button" onClick={handleClick}/>
}
```

***

### Slow DOM üòï

But JavaScript is fast, thanks to JIT compilation! üòé

***

### VirtualDOM ‚Äî takes the load off üòé

And updates the DOM when something has actually changed

***

### Only View in MV* üî®

React addresses one problem and does it well

</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 1. JSX ‚Äî Enhanced HTML

***

### Embedding React on the page

```js
//index.html
<div id="app"></div>
```

**Method 18+**
```js
//index.tsx
  const domNode = document.getElementById('app') as HTMLElement;
  const root = createRoot(domNode);
  root.render(<div className="fromReact"></div>);
```
**Old way**
```js
//index.tsx
ReactDom.render(<div className="fromReact"></div>,
  document.getElementById('app')
);
```

- Can be inserted anywhere, even in legacy code
- Can be used multiple times

***

### Differences in JSX Markup

JSX markup is similar to HTML, but there are differences

***

### Elements

React wrappers for embedded HTML

**HTML**
<pre><code class="lang-html hljs">&lt;div&gt;&lt;/div&gt; &lt;span&gt;&lt;/span&gt;</code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;div&gt;&lt;/div&gt; &lt;span&gt;&lt;/span&gt;</code></pre>

***

### Element names in lowercase

**HTML**
<pre><code class="lang-html hljs">&lt;div&gt;&lt;/div&gt; –∏–ª–∏ &lt;DIV&gt;&lt;/DIV&gt; –∏–ª–∏ &lt;Div&gt;&lt;/diV&gt;</code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;div&gt;&lt;/div&gt;</code></pre>

***

### Tags must be self-closing

Either with a closing tag:
```html
<div>Hello</div>
```

Or with a slash at the end:
```html
<br />
```

***

### Property naming in camelCase

Instead of dash-case

**HTML**
<pre><code class="lang-html hljs">&lt;input type="text" tabindex="0" onclick="alert()"&gt;</code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;input type="text" tabIndex="0" onClick="alert" /&gt;</code></pre>


***

### Two ways to pass attribute values

Through `""` as in HTML

<pre><code class="lang-html hljs">&lt;input type="text" tabIndex="0" /&gt;</code></pre>

Through `{}` with the ability to insert arbitrary JS code

<pre><code class="lang-html hljs">&lt;input type={"text"} tabIndex={a + 5} onClick={() => alert()} /&gt;</code></pre>

In this case, syntax highlighting and refactorings work in IDE

***

### Inserting computed values into markup

<pre><code class="lang-html hljs">&lt;div&gt;{Math.round(1000/3)}&lt;/div&gt;</code></pre>

***

### Escaping

```js
const title = response.potentiallyMaliciousInput;
// This is safe:
const element = <h1>{title}</h1>;
```

```js
function render() {
  const value = {__html: 'First &middot; Second'};
  return <div dangerouslySetInnerHTML={value} />;
}
```

***

### class ‚Üí className

**HTML**
<pre><code class="lang-html hljs">&lt;div class="red"&gt;&lt;/div&gt;</code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;div className="red"&gt;&lt;/div&gt;</code></pre>

class ‚Äî too popular word (already used in js)


***

### for ‚Üí htmlFor

**HTML**
<pre><code class="lang-html hljs">&lt;label for="something"&gt;Something&lt;/label&gt;
<input id="something" type="text"/></code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;label htmlFor="something"&gt;Someting&lt;/label&gt;
&lt;input id="something" type="text" /&gt;</code></pre>


***

### style ‚Äî it is just a JS-object

**HTML**
<pre><code class="lang-html hljs">&lt;div style="text-align: center; width: 5em; height: 100px"&gt;</code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;div style={{textAlign: "center", width: "5em", height: 100 }}&gt;</code></pre>

***

### value ‚Üí defaultValue,<br>checked ‚Üí defaultChecked

**HTML**
<pre><code class="lang-html hljs">&lt;input type="text" value="Candy"&gt;
&lt;input type="checkbox" checked&gt;
</code></pre>

**JSX**
<pre><code class="lang-html hljs">&lt;input type="text" defaultValue="Candy"/ &gt;
&lt;input type="checkbox" defaultChecked /&gt;
</code></pre>

- This is more logical
- In React, `value` and `checked` attributes are used to control the current value

***

### Task 1.1. Button
### Task 1.2. Input

***

### Babel: JSX ‚Üí JS

```js
var userName = 'Default user';

var mydom = _react2.default.createElement(
  'div',
  { className: 'root' },
  _react2.default.createElement(
    'div',
    { className: 'form' },
    _react2.default.createElement(
      'div',
      { style: { paddingRight: "10px", display: "inline-block" } },
      _react2.default.createElement(
        'label',
        { htmlFor: 'name' },
        '\u0418\u043C\u044F'
      )
    ),
    _react2.default.createElement('input', {
      id: 'name',
      type: 'text',
      size: '39',
      onChange: function onChange(event) {
        var target = event.target;
        debugger;
      },
      onBlur: function onBlur() {
        return alert('userName: ' + userName);
      }
    })
  )
);

_reactDom2.default.render(mydom, document.getElementById('app'));
```

***

### VirtualDOM ‚Äî generated during rendering

```json
{
  "type": "div",
  "key": null,
  "ref": null,
  "props": {
    "className": "root",
    "children": {
      "type": "div",
      "key": null,
      "ref": null,
      "props": {
        "className": "form",
        "children": [
          {
            "type": "div",
            "key": null,
            "ref": null,
            "props": {
              "style": {
                "paddingRight": "10px",
                "display": "inline-block"
              },
              "children": {
                "type": "label",
                "key": null,
                "ref": null,
                "props": {
                  "htmlFor": "name",
                  "children": "Name"
                },
                "_owner": null,
                "_store": {

                }
              }
            },
            "_owner": null,
            "_store": {

            }
          },
          {
            "type": "input",
            "key": null,
            "ref": null,
            "props": {
              "id": "name",
              "type": "text",
              "size": "39"
            },
            "_owner": null,
            "_store": {

            }
          }
        ]
      },
      "_owner": null,
      "_store": {

      }
    }
  },
  "_owner": null,
  "_store": {

  }
}
```

***

### VirtualDOM, DOM Elements, SyntheticEvent

<div style="text-align: center">Welcome to the `M A T R I X`</div>

</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 2. Functions, Loops, Branching

***

#### It's time to reap the benefits of transitioning to JSX!

***

### Functions and Methods

help us to eliminate duplication!

***

### Task 2.1. ExtractFunction

***

### Loops and `map`

**Loop**
```js
const listItems = [];
const numbers = [1, 2, 3, 4, 5];
for (const number of numbers) {
  listItems.push(<li>{number}</li>);
}
```

**map**
```js
const numbers = [1, 2, 3, 4, 5];
const listItems = numbers.map((number) =>
  <li>{number}</li>
);
```

***

### Keys

```js
const todoItems = todos.map((todo) =>
  <li key={todo.id}>
    {todo.text}
  </li>
);
```

Allow React to distinguish elements from each other
This is important during redraws

***

### Anti-pattern: Index

```js
const numbers = [1, 2, 3, 4, 5];
const listItems = numbers.map((number, index) =>
  <li key={index}>{number}</li>
);
```

Using an index as a key is bad because sorting can change.

More details in the *Reconciliation* section.

***

### Task 2.2. List

***

### Branching

**if-else**
```js
if (isLoggedIn) {
  return <UserGreeting />;
}
return <GuestGreeting />;
```

**Ternary Operator**
```js
The user is <b>{isLoggedIn ? 'currently' : 'not'}</b> logged in.
```

**&&**
```js
{unreadMessages.length > 0 &&
  <h2>You have {unreadMessages.length} unread messages.</h2>}
```

***

### Hide element

```js
function WarningBanner(props: Props) {
  if (!props.warn) {
    return null;
  }

  return (
    <div className="warning">
      Warning!
    </div>
  );
}
```

You can return `null`, `undefined` or `false`

***

### Task 2.3. Condition

</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 3. Components

***

### What are Components

They are like functions that return VirtualDOM nodes
```html
<MyComponent a="1" b="message" />
```

They can have nested nodes
```html
<Parent>
  <Child />
  <Child />
</Parent>
```

They can have internal state
```html
<TextInput defaultValue="Let's go" />
```

***

### Functional Components

```js
function MyComponent(props: Props): ReactNode {
  return (
      <div onClick={props.onFire}>{props.a} {props.b}</div>
  );
}
```

Properties ‚Äî input values of the component

Description of property types:
```ts
type Props = {
  a: number;
  b: string;
  onFire?: () => void;
};
```

***

### Destructuring props

```js
function MyComponent({a, b}: Props): ReactNode {
  return (
      <div>{a} {b}</div>
  );
}
```

***

### Children

```js
function Parent(props: ParentProps): ReactNode {
  return (<div className="green">{props.children}</div>);
}
```

```ts
type ParentProps = {
  a: number;
  b: string;
  children?: ReactNode;
};
```

***

### DefaultProps

Recommended:
```ts
type MyComponentProps = {
  b?: string;
}

function MyComponent({b = '–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é'}: MyComponentProps): ReactNode
```

Old React way (runtime btw):
```js
MyComponent.defaultProps = {
  value: 'Default'
}
```

***

### Using arrow function

```js
const MyComponent = ({a, b}: Props) => <div>{a} {b}</div>
```
```js
const MyComponent: (props: Props) => ReactNode
  = ({a, b}: Props) => <div>{a} {b}</div>
```

***

### Task 3.1. ExtractComponent

***

### Class-component

```js
class MyComponent extends React.Component<Props> {
  constructor(props: Props) {
    super(props);
  }

  render() {
    // Destructuring
    const { a, b } = this.props;
    return (
	  <div>{a} {b}</div>
    );
  }
}
```

***

### Components with state (Stateful)

```js
class Counter extends React.Component<Props, State> {
  constructor(props: Props) {
    super(props);
	this.state = { value: props.defaultValue, checked: false };
  }
  handleClick = () => {
    this.setState({
      value: this.state.value + this.props.step
    });
  }
  render() {
    return <div onClick={this.handleClick}
                className={this.state.checked && 'checked'}
           >{this.state.value}</div>;
  }
}
```

***

### Nuances

```js
// Arrow functions in JS capture 'this' where they are created,
// so they can be safely passed to onClick
handleClick = () => {
  // In state, there are value and checked,
  // but we pass only one ‚Äî it will be updated
  this.setState({
    value: this.state.value + this.props.step
  });
  // Here, this.state.value still has the old value.
}
```
<br>
You can't just write `this.state.value = newValue`
React won't track and render the changes

***

### Task 3.2. Toggle

***

### Functional vs Class

- Initially, class components provided more capabilities than functional components, but with the introduction of Hooks, capabilities became the same
- Functional components are definitely convenient for creating small components
- For large components, the choice in favor of class components is not obvious

##### Don't use class components in production (except ErrorBoundary)

***

### Controlled vs Uncontrolled

**Controlled input**
```js
render() {
  return <input value={this.state.value} onChange={this.handleChange} />;
}

handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
  this.setState({
    value: event.target.value
  });
}
```

**Uncontrolled input**
```js
<input defaultValue="default text"/>;
```

If you pass `undefined` to the `value` of a controlled component, the `input` will become uncontrolled!

***

### Stateless vs Statefull



***

### Lifting state up

<div style="margin-left: 20px; position: relative">
![children components](assets/LiftStateUp.png)

<div class="fragment" data-fragment-index="1" style="position: absolute; top: 0; background: white;">
  ![with parent component](assets/LiftStateUp2.png)
</div>
</div>

***

### Lifting State Up

Let component A store `valueA` in its state
Let component B store `valueB` in its state

If it turns out that these values need to be changed consistently, then you need to lift `valueA` and `valueB` to the state of the parent component

This is the *Lift State Up* technique

***

### Task 3.3. MoneyConverter

</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 4. Component life cycle

***

### Component life cycle stages

- Mounting
- Updating
- Unmounting
- Error Handling

***

### Life cycle methods
```js
// Mounting
constructor()
static getDerivedStateFromProps()
render()
componentDidMount()
```

```js
// Updating
static getDerivedStateFromProps()
shouldComponentUpdate()
render()
getSnapshotBeforeUpdate()
componentDidUpdate()
```

```js
// Unmounting
componentWillUnmount()
```

```js
// Error Handling
componentDidCatch()
```

***

`componentDidMount` has guarantees:
- It is called once
- `render` has definitely occurred by the time `componentDidMount` is called
- If `componentDidMount` is called, then `componentWillUnmount` will definitely be called as well

***

```js
// Mounting
componentDidMount()
```
It is suitable for making data requests from the server and subscribing to events.

<br>
<br>

```js
// Unmounting
componentWillUnmount()
```
It is suitable for cleaning up resources, unsubscribing from events.

***

### Task 4.1. Timer

</script></section>

<!-- ************************************************* -->

<section data-markdown><script type="text/template">

## 5. –î–æ—Å—Ç—É–ø –∫ DOM

***

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ DOM

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–æ–º, –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ–º –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏, –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞&nbsp;—Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏–ª–∏ –µ–≥–æ —Å–∫—Ä–æ–ª–ª–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏, —É–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏ DOM

***

### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫

** –°–ø–æ—Å–æ–± 16+ **
```js
constructor() {
  this.myRef = React.createRef<HTMLDivElement>();
}

render () {
  return <div ref={this.myRef} />
}
// –ü–æ—Å–ª–µ render —Å—Å—ã–ª–∫–∞ –æ–∫–∞–∂–µ—Ç—Å—è –≤ this.myRef.current
```

** –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± **
```js
myRef: HTMLDivElement | null

constructor() {
  this.myRef = null;
}

render () {
  return <div ref={r => this.myRef = r} />
}
// –ü–æ—Å–ª–µ render —Å—Å—ã–ª–∫–∞ –æ–∫–∞–∂–µ—Ç—Å—è –≤ this.myRef
```

***

### –ú–æ–∂–Ω–æ –ø–æ–≤–µ—à–∞—Ç—å –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```js
<input ref={this.myRef} /> // this.myRef = HTMLInputElement

```


```js
<MyComponent ref={this.myRef} /> // this.myRef = MyComponent

```

***

### –ó–∞–¥–∞—á–∞ 5. Focus

</script></section>

<section data-markdown><script type="text/template">

## 6. Hooks

***

### Hooks

–§—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏—á–∏ –∫–ª–∞—Å—Å–æ–≤

***

### useState

```js
function MyFunctionalComponent() {
  const [counter1, setCounter1] = useState(0);
  const [counter2, setCounter2] = useState(0);
  return (
    <>
      <div>
        <span>{counter1}</span>
        <button onClick={() => setCounter1(counter1 + 1)}>+</button>
      </div>
      <div>
        <span>{counter2}</span>
        <button onClick={() => setCounter2(—Å2 => c2 + 1)}>+</button>
      </div>
    </>
  )
}
```

***

### useRef

```js
function MyFunctionalComponent({value}) {
  const inputRef = useRef<HTMLInputElement>(null);

  return (
    <div>
      <input type="text" ref={inputRef} />
      <button onClick={() => inputRef.current.focus()}>
        –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–æ–∫—É—Å
      </button>
    </div>
  );
}
```

`useRef` ‚Äî —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –≤ –∫–ª–∞—Å—Å–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

***

### useEffect

```js
function MyFunctionalComponent({value}) {
  const timer = useRef(null);

  useEffect(() => {
    timer.current = setTimeout(console.log, 10000, '–ü—Ä–æ—à–ª–æ 10000 –º—Å');

    return () => { // –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∞ –∏ –≤ componentWillUnmount
      clearTimeout(timer.current);
    }
  }, [value]);

  ...
}
```
–°—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
- –ï—Å–ª–∏ `[value]`, —Ç–æ –ø—Ä–∏ `componentDidMount` –∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `value`
- –ï—Å–ª–∏ `[]`, —Ç–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ `componentDidMount`
- –ï—Å–ª–∏ `undefined`, —Ç–æ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞:
`componentDidMount` –∏ `componentDidUpdate`

***

### –ü–æ–º–Ω–∏—Ç–µ?

```js
class TimeDisplay extends React.Component {
  constructor() {
    super();
    this.state = { localTime: new Date() };
    this.localTickInterval = null;
  }
  componentDidMount() {
    this.localTickInterval = window.setInterval(() => {
      this.setState({ localTime: new Date() });
    }, 1000);
  }
  componentWillUnmount() { clearInterval(this.localTickInterval); }
  render() { return (<div>{this.state.localTime.toLocaleTimeString()}</div>); }
}
```

***

### –ê —Ç–µ–ø–µ—Ä—å –Ω–∞ —Ö—É–∫–∞—Ö! üòé

```js
function TimeDisplay() {
  const [localTime, setLocalTime] = useState(new Date());
  const localTickInterval = useRef(null);

  useEffect(() => {
    localTickInterval.current = window.setInterval(() => {
	  setLocalTime(new Date());
	}, 1000);

    return () => {
      clearInterval(localTickInterval.current);
    }
  }, []);

  return (<div>{localTime.toLocaleTimeString()}</div>);
}
```

***

### –ü–æ—á–µ–º—É —Ö—É–∫–∏ –ø–æ—è–≤–∏–ª–∏—Å—å?

- –ù–∏–∫—Ç–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ***this*** –≤ js
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–≤–∏–∑—É–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–∏—Ö —Ö—É–∫–æ–≤
- –ê–≥–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä. –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –æ—Ç–ø–∏—Å–∫–∏)

***

### –ü—Ä–∞–≤–∏–ª–æ —Ö—É–∫–æ–≤

- –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–æ —Å–ª–æ–≤–∞ ***use***
- —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- **–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**

***

### –ü–æ—á–µ–º—É —Ö—É–∫–∏ —Ç–æ–ª—å–∫–æ –≤ –Ω–∞—á–∞–ª–µ?

–ú–æ–∂–Ω–æ –Ω–µ –≤ –Ω–∞—á–∞–ª–µ, –Ω–æ —Ç–æ—á–Ω–æ –Ω–µ –Ω–∞–¥–æ –≤ —Ü–∏–∫–ª–∞—Ö –∏–ª–∏ —É—Å–ª–æ–≤–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö, –≤–µ–¥—å **React –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–∞ —Ö—É–∫–æ–≤**

```js
function Form() {
  // 1. Use the name state variable
  const [name, setName] = useState('Mary');

  // 2. Use an effect for persisting the form
  if (name !== '') {
    useEffect(function persistForm() {
      localStorage.setItem('formData', name);
    });
  }

  // 3. Use the surname state variable
  const [surname, setSurname] = useState('Poppins');
}
```

***

–ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤:
```js
useState('Mary')        // 1. –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 'Mary'
useEffect(persistForm)  // 2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º—É
useState('Poppins')     // 3. –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 'Poppins'
```

–í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å —É—Å–ª–æ–≤–∏–µ:
```js
useState('Mary')          // 1. –ß–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è, `Mary` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
// useEffect(persistForm) // üî¥ –≠—Ç–æ—Ç —Ö—É–∫ –ø—Ä–æ–ø—É—â–µ–Ω...
useState('Poppins')       // üî¥ 2 (–Ω–æ –±—ã–ª 3). –ù–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∑–∞—á–∏—Ç–∞—Ç—å —Ñ–∞–º–∏–ª–∏—é
```

***

### –ó–∞–¥–∞—á–∞ 6. Hooks

***

### –ï—â–µ –Ω–µ–º–Ω–æ–≥–æ —Ä–µ–¥–∫–∏—Ö —Ö—É–∫–æ–≤
–¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π üòâ

***

### useMemo

```js
function MyFunctionalComponent({value}) {
    const [square, cube] = useMemo(() => {
        return [Math.pow(value, 2), Math.pow(value, 3)];
    }, [value])

    return (
        <div>
            <div>–ó–Ω–∞—á–µ–Ω–∏–µ {value}</div>
            <div>–í –∫–≤–∞–¥—Ä–∞—Ç–µ {square}</div>
            <div>–í –∫—É–±–µ {cube}</div>
        </div>
    );
}
```

`useMemo` ‚Äî –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ç—è–∂–µ–ª–æ–≤–µ—Å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç

***

### useCallback

```js
function MyFunctionalComponent() {
    const logClick = useCallback(() => {
      console.log('Click');
    }, []);
    // –§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ,
    // –Ω–æ —Å—Å—ã–ª–∫–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è

    return (
        <>
            [1, 2, 3, 4, 5].map(value =>
              (<button onClick={logClick}>–ö–Ω–æ–ø–∫–∞ ‚Ññ{value}</button>)
            )
        </>
    );
}
```

`useCallback` ‚Äî *useMemo* –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é

***

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

1. –•—É–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ–≤ ***this***, –±–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É –∫–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç —á–∏—â–µ
2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Ö—É–∫–∞—Ö –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∑–∞–Ω–∏–º–∞—é—Ç –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞, –∏ –±–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –ø—Ä–æ—â–µ —á–∏—Ç–∞—é—Ç—Å—è
3. –•—É–∫–∏ –ø—Ä–æ—â–µ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å
4. –ë–æ–ª—å—à–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞ —Ö—É–∫–∞—Ö –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Å–ª–æ–∂–Ω—ã–º –¥–ª—è –ø—Ä–æ—á—Ç–µ–Ω–∏—è. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å –æ —Ä–∞–∑–±–∏–µ–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –Ω–∞ —á–∞—Å—Ç–∏ –∏–ª–∏ –æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ –≤–∏–¥–µ –∫–ª–∞—Å—Å–∞


</script></section>
<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## –ü—Ä–∞–∫—Ç–∏–∫–∞

***

### –ó–∞–¥–∞—á–∞

<img src="userProfile/drafts/reactForm.png" alt="–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ userProfile">

***

### –ì–∞–π–¥—ã

<a href="https://guides.kontur.ru/" target="_blank"><img src="assets/guides.png" alt="–°–∫—Ä–∏—à–Ω–æ—Ç –ö–æ–Ω—Ç—É—Ä.–ì–∞–π–¥–æ–≤"></a>

***

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ React-UI

<a href="http://tech.skbkontur.ru/react-ui/"><img src="assets/react-ui.png" style="border: 1px solid #aaa"
                                                  alt="–°–∫—Ä–∏—à–Ω–æ—Ç React-UI"></a>

***

### –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

<a href="http://tech.skbkontur.ru/react-ui/#/Input" target="_blank">http://tech.skbkontur.ru/react-ui/#/Input</a>

<img src="assets/react-ui-important.png" alt="–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—É–Ω–∫—Ç—ã view code –∏ props&methods">


***

### –ó–∞–¥–∞—á–∞ userProfile

1. –ü–µ—Ä–µ–π–¥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∑–∞–¥–∞—á–∏: –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è userProfile
2. –£—Å—Ç–∞–Ω–æ–≤–∏ –≤ –Ω–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `npm i`
3. –ó–∞–ø—É—Å—Ç–∏ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –∫–æ–º–∞–Ω–¥–æ–π `npm start`
4. –í –±—Ä–∞—É–∑–µ—Ä–µ –æ—Ç–∫—Ä–æ–π <a href="http://localhost:8081">http://localhost:8081</a>
5. –í —Ñ–∞–π–ª–µ `src/index.tsx` –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è


***

### –û–±—Å—É–∂–¥–µ–Ω–∏–µ. –ü—É–Ω–∫—Ç 7.

1. –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ?
2. –ö–æ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ?
3. –ö–∞–∫ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ?


</script></section>

<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 7. Reconciliation

***

### –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```js
class Parent extends React.Component {
  constructor(props) { ... }
  render() {
    const { text } = this.props;
    const { a, b } = this.state;
    return (
	  <div>
	    <h1>{text}</h1>
	    <Child a={a} b={b} />
	  </div>
	);
  }
}
```

***

### –ê–ª–≥–æ—Ä–∏—Ç–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–í—Å–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `ReactDom.render` –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ `render`
...
- Parent constructor
- Parent render
  - h1 render
  - Child constructor
  - Child render
    - ...

***

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ú–æ–∂–µ—Ç –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–º–µ–Ω—è—Ç—å —Å–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ?
–ú–æ–∂–µ—Ç –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —Å–µ–±—è?

***

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —Å–µ–±—è –∏–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ,
–Ω–æ –º–æ–∂–µ—Ç –ø–æ–º–µ–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ `setState` –∏ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞–Ω

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞–Ω, –µ—Å–ª–∏ –µ–≥–æ *—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç* –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞–Ω

*–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–∞—Å—Å–∏–≤–µ–Ω*: –∫–æ–≥–¥–∞ –∏ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–µ—à–∞–µ—Ç React

***

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–° —á–µ–≥–æ –≤—Å–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è?**

```js
class Parent extends React.Component {
  constructor(props) { ... }
  render() {
    const { text } = this.props;
    const { a, b } = this.state;
    return (
	  <div>
	    <h1>{text}</h1>
	    <Child a={a} b={b} />
	  </div>
	);
  }
}
```


***

–õ—é–±–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ `setState` –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —É—Ä–æ–≤–Ω–µ

- Parent setState
- Parent render
  - h1 render
  - Child –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
  - Child render
    - ...

*–ù–æ –≤–æ–∑–º–æ–∂–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã!*

***

### –ü—É—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫

```js
  if (a > 10) {
    return (
      <div>
        <h1>{text}</h1>
        <Bastard a={a} b={b} />
        <Child a={a} b={b} />
      </div>
    );
  }
  return (
    <div>
      <h1>{text}</h1>
      <Child a={a} b={b} />
    </div>
  );

```

***

### –ù–∞ –º–µ—Å—Ç–µ Child –æ–∫–∞–∑–∞–ª—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Bastard

```js
<div>
  <h1>{text}</h1>
  <Bastard a={a} b={b} />
  <Child a={a} b={b} />
</div>
```

–î–∞–∂–µ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã–π Child –∏–¥–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ...

```html
–°—Ç–∞—Ä—ã–π Child —Å–Ω–æ—Å–∏—Ç—Å—è: componentWillUnmount

Bastard —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è: constructor, ... render, componentDidMount

–ù–æ–≤—ã–π Child —Ä–∞–∑–º–µ—á–∞–µ—Ç—Å—è: constructor, ... render, componentDidMount
```

***

### Child –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –ø—Ä–µ–∂–Ω–µ–º –º–µ—Å—Ç–µ

React –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Child,
–≤—ã–∑—ã–≤–∞—è –º–µ—Ç–æ–¥—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

```js
// Updating
static getDerivedStateFromProps()
shouldComponentUpdate()
render()
getSnapshotBeforeUpdate()
componentDidUpdate()
```

***

### –¢–∞–∫ –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é

```js
return (
  <div>
    <h1>{text}</h1>
    {a > 10 && <Bastard a={a} b={b} />}
    <Child a={a} b={b} />
  </div>
);

```

***

### –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```js
// Updating
shouldComponentUpdate(nextProps, nextState)
```

***

### Reconciliation ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ

<p style="text-align: center"><img src="assets/should-component-update.png"></p>

***

### ShouldComponentUpdate –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–ü–æ —Å—É—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫:
```js
shouldComponentUpdate(nextProps, nextState) {
  return true;
}
```

***

### PureComponent

–ü–æ —Å—É—Ç–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç SCU —Ç–∞–∫:
```js
shouldComponentUpdate(nextProps, nextState) {
  return !shallowEqual(this.props, nextProps);
}
```

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
```js
class MyPureComponent extends React.PureComponent {
  ...
}
```

***

#### PureComponent –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç render —Ä–æ–¥–∏—Ç–µ–ª—è

```js
class Child extends React.PureComponent { ... }

class Parent extends React.Component {
  constructor(props) { ... }
  render() {
    const { text } = this.props;
    const { a, b } = this.state;
    return (
	  <div>
	    <h1>{text}</h1>
	    <Child a={a} b={b} />
	  </div>
	);
  }
}
```

***

#### –ù–æ –Ω–µ –≤—Å–µ–≥–¥–∞...

```js
class Child extends React.PureComponent { ... }

class Parent extends React.Component {
  constructor(props) { ... }
  render() {
    const { text } = this.props;
    const { a, b } = this.state;
    return (
	  <div>
	    <h1>{text}</h1>
	    <Child a={a} b={b} onClick={() => { alert('!'); }} />
	  </div>
	);
  }
}
```

–¢–∞–∫ –∑–∞—á–µ–º –º—ã –ø–∏—à–µ–º —Å—Ç—Ä–µ–ª–æ—á–Ω—ã–µ-–º–µ—Ç–æ–¥—ã –≤–∏–¥–∞ handleClick?

***

#### shouldComponentUpdate –∏ PureComponent –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

```js
const Button = props => {
  // –≤–∞—à –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
};

const areEqual = (prevProps, nextProps) => {
  // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º true, –µ—Å–ª–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–ø—Å–æ–≤ –Ω–µ –Ω—É–∂–µ–Ω —Ä–µ–Ω–¥–µ—Ä
};

export default React.memo(Button, areEqual);
```

–í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ *React.memo*, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ *PureComponent*

***

#### –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤ Hooks

```js
const MyFunctionalComponent = ({ value }) => {
  const cachedObject = useMemo(() => ({
    value: 5,
    doSomething: () => {...},
    doSomethingElse: () => {...}
  })), []);

  const onSave = useCallback(() => {
    executeSomethingOnSave();
  }, []);

  return (
    <PureOrMemoizedComponent onSave={onSave} value={cachedObject} />
  );
});
```

`useCallback` –∏ `useMemo` –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî —ç—Ç–æ *PureComponent*, –∫–ª–∞—Å—Å-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º *shouldComponentUpdate* –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–±–µ—Ä–Ω—É—Ç—ã–π –≤ *React.memo*
–í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –º–µ–º–æ–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ–π

***

### –ó–∞–¥–∞—á–∞ 7. UsersTable


</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 8. Higher Order Components

***

*Higher Order Components (HOC)* ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏
–≤–∏–¥–∞ Component ‚Üí Component

–ò—Å–ø–æ–ª—å–∑—É—è HOC, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ –æ–±—ã—á–Ω—ã—Ö:
```js
const EnhancedComponent = enhance(JustComponent); // enhance ‚Äî —ç—Ç–æ HOC
```

***

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ enhance

```js
// –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç...
function enhance<T extends {}>(WrappedComponent: React.ComponentType<T>) {
      // ...—Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç...
      const Enhanced: React.FC<EnhanceHOCProps & T> = props => {

        return ( // –†–µ–Ω–¥–µ—Ä–∏–º –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
            <span className={props.value2}>
                { props.value1 }
                <WrappedComponent {...props} isSelected={true} />
            </span>
        )}

    return Enhanced; // ...–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
}
```

***

### –î–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏

1. –ù–µ –º—É—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
2. –í—Å–µ –ø—Ä–æ–ø—Å—ã –ø—Ä–æ–∫–∏–¥—ã–≤–∞—Ç—å –¥–∞–ª—å—à–µ,
   –∫—Ä–æ–º–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–µ—Ä—Ç–∫–∏
3. –ó–∞–¥–∞–≤–∞—Ç—å displayName: –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ –¥–µ–±–∞–≥–µ

```js
const wrappedName =
  WrappedComponent.displayName || WrappedComponent.name || 'Component';

Enhanced.displayName = `Enhanced(${wrappedName})`;

return Enhanced
```

***

### Forwarded Ref

```js
const someRef = React.createRef();
<EnhancedButton label="Click Me" ref={someRef} />;
```
```js
type EnhanceHOCProps = {
    forwardedRef?: React.ForwardedRef<unknown>
    }
```
```js
function enhance<T extends {}>(WrappedComponent: React.ComponentType<T>)  {
  const Enhanced: React.FC<EnhanceHOCProps & T> = props => {
    return <WrappedComponent ref={forwardedRef} {...rest} />
  }
  // React –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ "ref" –≤ props –æ–±—ã—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
  // –ù–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç React.forwardRef –¥–∞–µ—Ç –Ω–∞–º –¥–æ—Å—Ç—É–ø –∫ –∑–Ω–∞—á–µ–Ω–∏—é –∞—Ç—Ä–∏–±—É—Ç–∞ "ref"
  // –∏ —Ç–µ–ø–µ—Ä—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –ø–æ–¥ –¥—Ä—É–≥–∏–º –∏–º–µ–Ω–µ–º.
  return React.forwardRef((props, ref) => {
    return <Enhanced {...props} forwardedRef={ref} />;
  });
}
```

***

### –ó–∞–¥–∞—á–∞ 8. FormRow

***

### –ü—Ä–∏–º–µ—Ä—ã HOC

–†–æ—É—Ç–µ—Ä
```js
const NavbarWithRouter = withRouter(Navbar);
```

Relay
```js
const CommentWithRelay = Relay.createContainer(Comment, config);
```

Redux connect
```js
const ConnectedComment = connect(commentSelector, commentActions)(CommentList);
```

***

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ HOC

1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É. –ö–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö —Å –†–æ—É—Ç–µ—Ä–æ–º –∏ –†–µ–¥–∞–∫—Å–æ–º
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ç–∫–∏ –∏ –º–µ—Ç–æ–¥–æ–≤. –ö–∞–∫ –≤ —Ä–µ—à–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∫–µ

***

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ç–∫–∏ –±–µ–∑ –ª–æ–≥–∏–∫–∏

```js
const FormRow = ({label, children}) => {
  return (
    <div className="row">
      <div className="label">{label}</div>
      {children}
    </div>
  );
}
```

–¢–∞–∫–∂–µ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω [RenderProps](https://ru.reactjs.org/docs/render-props.html)

***

### Wrapper Hell

```js
const withCustomization = WithCustomization(CheckForm);
const withIdentity = WithFormData(withCustomization, FormIdentity, false);
const withDocuments = WithFormData(withIdentity, FormDocuments, true);
const withSignStatement = WithFormData(withDocuments, SignStatementData, true);

const mapStateToProps = state => ({editableForm: state.forms.editableForm});
const mapDispatchToProps = dispatch => bindActionCreators({
  saveForm,
  changeFormStep,
  getFormData
}, dispatch);

export default connect(
  mapStateToProps,
  mapDispatchToProps
)(withSignStatement);
```

***

### –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

–ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ *Hooks* –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏, –∏–∑–±–µ–≥–∞—è –ø—Ä–∏ —ç—Ç–æ–º *WrapperHell*

```js
function useMyOwnHook(initialValue) {
  const [value, setValue] = useState(initialValue);
  const [value2, setValue2] = useState(initialValue);

  useEffect(() => {
    ...
    return () => {
      ...
    };
  }, []);

  return [value, value2];
}
```

</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## 9. Context

***

<p style="text-align: center"><img src="assets/states.png"></p>

***

–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
```js
const CakeContext = React.createContext();
```

–ü–æ—Å—Ç–∞–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è:
```html
<CakeContext.Provider value={cheeseCake}>
  ...
</CakeContext.Provider>
```

–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```html
<CakeContext.Consumer>
  {cake => <Hungry food={cake} />}
</CakeContext.Consumer>
```

***

### –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

–ë–µ–∑ —Ö—É–∫–æ–≤:
```js
function Glutton() {
  return (
    <CakeContext.Consumer>
      {cake => <Hungry food={cake} />}
    </CakeContext.Consumer>
  );
}
```

–° —Ö—É–∫–∞–º–∏:
```js
function Glutton() {
  const cake = useContext(CakeContext);
  return <Hungry food={cake} />;
}
```

***

### –ó–∞–¥–∞—á–∞ 9. ColorsOfTime


</script></section>


<!-- ************************************************* -->


<section data-markdown><script type="text/template">

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ


***

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
–ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –ø–æ —Å—Å—ã–ª–∫–µ
<a href="http://bit.ly/kontur-courses-feedback">http://bit.ly/kontur-courses-feedback</a>

</script></section>

</div></div>
</body>
</html>
